# アプリ概要・画面設計

## アプリ概要

### アプリ名
**FSCodeReviewTool** - AIによるシンプルなコードレビューアプリ

### コンセプト
プログラミング初級者〜中級者が作成したJavaコードに対して、AIが優しい表現でコードレビューを行うWebアプリケーション。ログイン不要で、コードを貼り付けるだけで即座にレビュー結果を取得できる。

### 主な特徴
- **ログイン不要**: 誰でもすぐに使える
- **シンプルな操作**: コードを貼り付けて「レビュー実行」を押すだけ
- **AIレビュー**: Gemini / Azure OpenAI によるコードレビュー
- **コメント追加形式**: レビュー結果はソースコード内にコメントとして追加
- **プロンプト管理**: レビュー観点をカスタマイズ可能
- **複数ファイル対応**: 複数ファイルのプロジェクトも一括レビュー可能
- **複数ファイルドラッグ&ドロップ**: 複数ファイルを一度にドロップして読み込み可能
- **全ファイル一括レビュー**: 登録した全ファイルをまとめてAIレビュー実行

---

## 画面構成

入力画面と結果画面を **切り替え式** で表示し、エディタを大きく活用する。

```
┌─────────────────────────────────────────────────────────────────┐
│                        ヘッダー                                  │
│  [ロゴ: FSCodeReviewTool]              [プロンプト管理] [設定]   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  [ コード入力 ]  [ レビュー結果 ]     ← 画面切り替えタブ  │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ===== コード入力モード =====                                    │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ [Main.java] [Sub.java] [+]         ファイルタブ          │   │
│  ├─────────────────────────────────────────────────────────┤   │
│  │                                                         │   │
│  │  // Monaco Editor（大きく表示）                          │   │
│  │  // ファイルをドラッグ&ドロップで追加可能                 │   │
│  │                                                         │   │
│  │                                                         │   │
│  │                                                         │   │
│  │                                                         │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  プロンプト: [▼ 中級編AIコードレビュー ]  [ レビュー実行 ▶ ]   │
│                                                                 │
│  ===== レビュー結果モード =====                                  │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ [Main.java] [Sub.java]             ファイルタブ          │   │
│  ├─────────────────────────────────────────────────────────┤   │
│  │                                                         │   │
│  │  // レビュー結果（Monaco Editor、読み取り専用）           │   │
│  │  // コメント追加済みコードを表示                          │   │
│  │                                                         │   │
│  │                                                         │   │
│  │                                                         │   │
│  │                                                         │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  [ 📋 コピー ] [ 💾 ダウンロード ] [ 📦 全ファイルDL ] [← 戻る] │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 画面詳細

### 1. メイン画面（トップページ）

**URL**: `/`

**機能**:
- コード入力（テキストエリア）
- 複数ファイルのドラッグ&ドロップ（一度に複数ファイルを読み込み可能）
- 複数ファイルのタブ管理
- プロンプト選択
- 全ファイル一括レビュー実行
- レビュー結果表示（ファイルごとにタブ切り替え）
- 結果のコピー/ダウンロード/全ファイル一括ダウンロード

**UI要素**:

| 要素 | 説明 |
|-----|------|
| ヘッダー | ロゴ、プロンプト管理リンク、設定リンク |
| 画面切り替えタブ | 「コード入力」と「レビュー結果」を切り替え |
| ファイルタブ | 複数ファイルを切り替え表示。[+]ボタンでファイル追加 |
| Monaco Editor | シンタックスハイライト付きエディタ。複数ファイルのドラッグ&ドロップ対応 |
| プロンプト選択 | ドロップダウンでプロンプトテンプレート選択 |
| レビュー実行ボタン | 全ファイルを一括でAIレビュー実行。実行後は自動で結果画面に切り替え |
| コピーボタン | 現在表示中のファイルをクリップボードにコピー |
| ダウンロードボタン | 現在表示中のファイルをダウンロード |
| 全ファイルDLボタン | 全ファイルをZIPでダウンロード |
| 戻るボタン | コード入力画面に戻る |

**画面状態**:
- **入力モード**: コード入力・編集画面。ファイル追加・削除・編集が可能
- **結果モード**: レビュー結果表示画面。レビュー完了後に自動遷移
- **レビュー中**: ローディングオーバーレイ表示

---

### 2. プロンプト管理画面

**URL**: `/prompts`

**機能**:
- プロンプトテンプレート一覧表示
- プロンプト追加/編集/削除
- デフォルトプロンプトの設定

**画面イメージ**:

```
┌─────────────────────────────────────────────────────────────────┐
│                        ヘッダー                                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  プロンプト管理                         [ + 新規作成 ]           │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ ⭐ 中級編AIコードレビュープロンプト                      │   │
│  │    Java初級者向けの詳細なレビュー観点を含むプロンプト     │   │
│  │    [ 編集 ] [ 削除 ] [ デフォルトに設定 ]                │   │
│  ├─────────────────────────────────────────────────────────┤   │
│  │    簡易レビュープロンプト                                │   │
│  │    シンプルなコードレビュー用プロンプト                   │   │
│  │    [ 編集 ] [ 削除 ] [ デフォルトに設定 ]                │   │
│  ├─────────────────────────────────────────────────────────┤   │
│  │    セキュリティ重視プロンプト                            │   │
│  │    セキュリティ観点に特化したレビュープロンプト            │   │
│  │    [ 編集 ] [ 削除 ] [ デフォルトに設定 ]                │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**UI要素**:

| 要素 | 説明 |
|-----|------|
| プロンプト一覧 | 登録済みプロンプトをカード形式で表示 |
| 新規作成ボタン | プロンプト作成モーダルを開く |
| 編集ボタン | プロンプト編集モーダルを開く |
| 削除ボタン | プロンプトを削除（確認ダイアログあり） |
| デフォルト設定 | メイン画面で初期選択されるプロンプトを設定 |
| ⭐マーク | デフォルトプロンプトを示す |

---

### 3. プロンプト作成/編集モーダル

**機能**:
- プロンプト名入力
- プロンプト内容入力
- 説明入力
- 保存/キャンセル

**画面イメージ**:

```
┌─────────────────────────────────────────────────────────────────┐
│  プロンプト編集                                         [×]     │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  プロンプト名 *                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 中級編AIコードレビュープロンプト                          │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  説明                                                          │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ Java初級者向けの詳細なレビュー観点を含むプロンプト         │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  プロンプト内容 *                                               │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 【あなたへの指示】                                       │   │
│  │ あなたは日本のIT企業に勤める教育担当エンジニアです。      │   │
│  │ これから、プログラミングを学習中の初級者が作成した        │   │
│  │ Javaソースコードに対してコードレビューを行ってください。  │   │
│  │ ...                                                      │   │
│  │                                                          │   │
│  │                                                          │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│                              [ キャンセル ] [ 保存 ]            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

### 4. 設定画面

**URL**: `/settings`

**機能**:
- AI プロバイダー選択（Gemini / Azure OpenAI）
- API キー設定（※ 環境変数推奨だが、画面からも設定可能に）

**画面イメージ**:

```
┌─────────────────────────────────────────────────────────────────┐
│                        ヘッダー                                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  設定                                                           │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ AI プロバイダー                                          │   │
│  │                                                          │   │
│  │  ○ Google AI (Gemini)                                   │   │
│  │  ● Azure OpenAI                                         │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ API設定（環境変数が優先されます）                        │   │
│  │                                                          │   │
│  │ Gemini API Key                                          │   │
│  │ [●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●] [表示/非表示]         │   │
│  │                                                          │   │
│  │ Azure OpenAI Endpoint                                   │   │
│  │ [https://xxxxx.openai.azure.com/                    ]   │   │
│  │                                                          │   │
│  │ Azure OpenAI API Key                                    │   │
│  │ [●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●] [表示/非表示]         │   │
│  │                                                          │   │
│  │ Azure OpenAI Deployment                                 │   │
│  │ [gpt-4o                                              ]   │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│                                        [ 保存 ]                 │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**備考**:
- API キーは環境変数（`.env.local`）での設定を推奨
- 画面から設定した値はローカルストレージに保存（セキュリティ注意）
- 環境変数が設定されている場合は環境変数を優先

---

## 画面遷移図

```
┌──────────────────┐
│   メイン画面     │ ─────────────────────────────┐
│       /          │                              │
└────────┬─────────┘                              │
         │                                        │
         │ ヘッダーリンク                          │
         │                                        │
         ├─────────────────────┐                  │
         │                     │                  │
         ▼                     ▼                  │
┌──────────────────┐  ┌──────────────────┐       │
│ プロンプト管理   │  │     設定         │       │
│    /prompts      │  │   /settings      │       │
└────────┬─────────┘  └──────────────────┘       │
         │                                        │
         │ モーダル表示                            │
         ▼                                        │
┌──────────────────┐                              │
│ プロンプト編集   │                              │
│   (モーダル)     │                              │
└──────────────────┘                              │
                                                  │
         ◄────────────────────────────────────────┘
              すべての画面からメイン画面へ戻れる
```

---

## レスポンシブ対応

### デスクトップ（1024px以上）
- 2カラムレイアウト可能（入力と結果を横並び）
- フルサイズのコードエディタ

### タブレット（768px〜1023px）
- 1カラムレイアウト
- コードエディタの高さを調整

### モバイル（767px以下）
- 1カラムレイアウト
- タブは横スクロール
- ボタンはフルワイド

---

## 次のステップ

1. [02_機能設計.md](./02_機能設計.md) - 各機能の詳細仕様
2. [03_API設計.md](./03_API設計.md) - API エンドポイント定義
3. [04_データベース設計.md](./04_データベース設計.md) - データベーススキーマ
